// Code generated by goxploit msfrpc LibraryGenerator. DO NOT EDIT.

package metasploit

import (
	"errors"
	"github.com/arisinghackers/goxploit/pkg/msfrpc"
)

type Job struct {
	*msfrpc.MsfRpcClient
}

func NewJob(client *msfrpc.MsfRpcClient) *Job {
	return &Job{client}
}

func (c *Job) List(token string) (map[string]interface{}, error) {
	resp, err := c.MsfRequest([]interface{}{"job.list", c.Token})
	if err != nil {
		return nil, err
	}
	if result, ok := resp["result"]; ok && result == "failure" {
		return nil, errors.New("Unprocessable Content")
	}
	if errMsg, ok := resp["error_message"]; ok {
		return nil, errors.New(errMsg.(string))
	}
	return resp, nil
}

func (c *Job) Info(token string, jobId string) (map[string]interface{}, error) {
	resp, err := c.MsfRequest([]interface{}{"job.info", c.Token, jobId})
	if err != nil {
		return nil, err
	}
	if result, ok := resp["result"]; ok && result == "failure" {
		return nil, errors.New("Unprocessable Content")
	}
	if errMsg, ok := resp["error_message"]; ok {
		return nil, errors.New(errMsg.(string))
	}
	return resp, nil
}

func (c *Job) Stop(token string, jobId string) (map[string]interface{}, error) {
	resp, err := c.MsfRequest([]interface{}{"job.stop", c.Token, jobId})
	if err != nil {
		return nil, err
	}
	if result, ok := resp["result"]; ok && result == "failure" {
		return nil, errors.New("Unprocessable Content")
	}
	if errMsg, ok := resp["error_message"]; ok {
		return nil, errors.New(errMsg.(string))
	}
	return resp, nil
}

